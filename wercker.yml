box: wercker/golang

build:
  steps:
    - script:
        name: run tests
        code: |
          go test

deploy:
  steps:
    - script:
        name: install gobump
        code: |
          go get github.com/motemen/gobump/cmd/gobump
    - script:
        name: bump version
        code: |
          gobump -patch -w
    - script:
        name: setup user
        code: |
          git config --global user.email "pleasemailus@wercker.com"
          git config --global user.name "werckerbot"
    - script:
        name: commit and push
        code: |
          ! git diff --quiet || ( git commit -a -m 'bump version' && git push https://$GITHUB_TOKEN@github.com/motemen/test-repository HEAD:master )
